{% extends 'base.html' %}

{% block page_content %}
<p><a href="{{ url_for(prefixe_url + '.create' + suffixe_url) }}" class="btn btn-primary" style="width:100%;">cr√©er</a></p>
{% include 'components/gridview.html' %}
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/jquery-ui.min.js') }}"></script>
<script>
$(function(){
    $('.sortable').sortable({
        stop: function( event, ui ) {
            var projects = [];
            $('tr', $(this)).each(function(i){
                var $row_sort = $('.row_sort', $(this));
                $row_sort.val(i + 1);
                $('.txtSort', $(this)).text(i + 1);
                projects.push({
                    "id": $('.row_id', $(this)).val(),
                    "sort": $row_sort.val()
                });
            });
            $.ajax({
                url: window.location.href + '/update-portfolio-sort',
                method: 'post',
                data: JSON.stringify(projects),
                contentType: "application/json",
                done: function(e){
                    console.log(e);
                }
            });
        }
    });
});
</script>
{% endblock scripts %}
